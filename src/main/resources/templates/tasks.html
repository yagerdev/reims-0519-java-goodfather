<!DOCTYPE html>
<html lang="FR">
    <div th:replace="fragments/head.html :: head"></div>

    <body>
        <div th:replace="fragments/header.html :: header"></div>
        <div th:replace="fragments/nav.html :: nav"></div>
        <main class="container">
            <h2 th:text="'Projet : ' + ${project.name}">Nom du projet</h2>
            <h3 class="yellow-gf mb-3" th:text="${room.name}">
                Nom de la pièce
            </h3>
            <div class="input-group mb-1">
                <div class="input-group-prepend read-project">
                    <span class="input-group-text flex-centered">
                        Commentaire
                    </span>
                </div>
                <div class="form-control" th:text="${room.comment}">
                    Commentaire
                </div>
            </div>
            <table class="table table-striped table-dark">
                <thead>
                    <tr>
                        <th>MUR A</th>
                        <th>MUR B</th>
                        <th>Sol / Plafond</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td th:text="${room.wallA + ' cm'}">item</td>
                        <td th:text="${room.wallB + ' cm'}">item</td>
                        <td th:text="${room.height + ' cm'}">item</td>
                    </tr>
                    <tr>
                        <td
                            th:text="${T(Math).round((room.wallA/100)*(room.height/100)*100.00)/100.00 + ' m²'}"
                        >
                            item
                        </td>
                        <td
                            th:text="${T(Math).round((room.wallB/100)*(room.height/100)*100.00)/100.00 + ' m²'}"
                        >
                            item
                        </td>
                        <td
                            th:text="${T(Math).round((room.wallB/100)*(room.wallA/100)*100.00)/100.00 + ' m²'}"
                        >
                            item
                        </td>
                    </tr>
                </tbody>
            </table>

            <section class="action-recap-project-container mb-3">
                <div
                    class="alert alert-info d-flex justify-content-between align-items-center"
                    role="alert"
                >
                    Fourchette basse :
                    <span
                        class="alert-link"
                        th:text="${T(Math).round(project.lowerTotalCost) + ' €'}"
                    >
                        prix
                    </span>
                </div>
                <div
                    class="alert alert-warning d-flex justify-content-between align-items-center"
                    role="alert"
                >
                    Fourchette haute :
                    <span
                        class="alert-link"
                        th:text="${T(Math).round(project.upperTotalCost) + ' €'}"
                    >
                        prix
                    </span>
                </div>
                <a
                    th:href="@{'/projects/' + ${project.id} + '/edit'}"
                    class="btn btn-outline-info d-flex justify-content-center align-items-center"
                >
                    Nouvelle pièce
                </a>
                <a
                    th:href="@{'/projects/' + ${project.id}}"
                    class="btn btn-outline-info d-flex justify-content-center align-items-center"
                    >Finir projet</a
                >
            </section>

            <form th:method="POST" th:action="@{/task/add}">
                <input type="hidden" name="room" th:value="${room.id}" />
                <div class="input-group mb-3">
                    <div class="input-group-prepend read-project">
                        <label class="input-group-text flex-centered" for="inputGroupSelect01"
                            >Typologie</label
                        >
                    </div>
                    <select
                        class="custom-select"
                        id="typology"
                        th:name="typology"
                    >
                        <option selected disabled>Sélectionnez...</option>
                        <option
                            th:each="typology : ${typologies}"
                            th:text="${typology.name}"
                            th:value="${typology.id}"
                        >
                            item
                        </option>
                    </select>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend read-project">
                        <label class="input-group-text flex-centered" for="work"
                            >Travaux</label
                        >
                    </div>
                    <select class="custom-select" id="work" th:name="work">
                        <option selected disabled>Sélectionnez...</option>
                        <option
                            th:each="task : ${tasks}"
                            th:text="${task.work.name}"
                            th:value="${task.work.id}"
                            th:attr="filter=${task.typology.id}"
                            >item</option
                        >
                    </select>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend read-project">
                        <label class="input-group-text flex-centered" for="material"
                            >Matériaux</label
                        >
                    </div>
                    <select
                        class="custom-select"
                        id="material"
                        th:name="material"
                    >
                        <option selected disabled>Sélectionnez...</option>
                        <option
                            th:each="task : ${tasks}"
                            th:text="${task.material.name}"
                            th:value="${task.material.id}"
                            th:attr="filter=${task.typology.id + ' ' + task.work.id}"
                            >item</option
                        >
                    </select>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend read-project">
                        <label class="input-group-text flex-centered" for="quantity"
                            >Quantité</label
                        >
                    </div>
                    <input
                        type="number"
                        class="form-control"
                        name="quantity"
                        required
                    />
                </div>
                <button type="submit" class="btn btn-info">Ajouter</button>
                <a
                    th:href="@{'/projects/' + ${project.id}}"
                    class="btn btn-info"
                    >Finir projet</a
                >
                <a
                    th:href="@{'/projects/' + ${project.id} + '/edit'}"
                    class="btn btn-info"
                    >Ajouter une nouvelle pièce</a
                >
            </form>

            <section class="section-list list-task-room">
                <h3 class="mb-4">Liste des travaux ajoutées :</h3>
                <form
                    th:action="@{'/quantity'}"
                    th:method="DELETE"
                    class="list-group"
                    th:each="quantity : ${quantities}"
                >
                    <input
                        class="list-group-item"
                        th:value="${quantity.task.constructName() + ' - ' + quantity.quantity*quantity.task.price} + '€'"
                    />
                    <input
                        type="hidden"
                        th:value="${quantity.id}"
                        th:name="quantity"
                    />
                    <button type="submit" class="btn btn-info">
                        <ion-icon
                            ios="ios-close"
                            md="md-close"
                            class="icon-delete"
                        ></ion-icon>
                    </button>
                </form>
            </section>
        </main>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script th:src="@{/JS/filter_task.js}"></script>
        <div th:replace="fragments/footer.html :: footer"></div>
        <div th:replace="fragments/script.html :: script"></div>
    </body>
</html>
