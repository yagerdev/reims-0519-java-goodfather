<!DOCTYPE html>
<html lang="FR">
<div th:replace="fragments/head.html :: head"></div>

<body>
    <div th:replace="fragments/header.html :: header"></div>
    <div th:replace="fragments/nav.html :: nav"></div>
    <main class="container">
        <h2 th:text="'Projet : ' + ${project.name}">Nom du projet</h2>
        <h3 class="yellow-gf" th:text="${room.name}">Nom de la pièce</h3>
        <table class="table table-striped table-dark">
            <thead>
                <tr>
                    <th>MUR A</th>
                    <th>MUR B</th>
                    <th>Sol / Plafond</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td th:text="${room.wallA + ' cm'}">item</td>
                    <td th:text="${room.wallB + ' cm'}">item</td>
                    <td th:text="${room.height + ' cm'}">item</td>
                </tr>
                <tr>
                    <td th:text="${surfaceA + ' m²'}">
                        item
                    </td>
                    <td th:text="${surfaceB + ' m²'}">
                        item
                    </td>
                    <td th:text="${ground + ' m²'}">
                        item
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="input-group mb-1">
            <div class="input-group-prepend read-project">
                <span class="input-group-text flex-centered">
                    Commentaire
                </span>
            </div>
            <div class="form-control" th:text="${room.comment}">
                Commentaire
            </div>
        </div>
        <p>Prix total : <span class="yellow-gf" th:text="${room.lowerTotalCost + ' - ' + room.upperTotalCost + '€'}">Prix des travaux de la pièce</span></p>

        <form th:method="POST" th:action="@{/task/add}">
            <input type="hidden" name="room" th:value="${room.id}" />
            <div class="input-group mb-3">
                <div class="input-group-prepend read-project">
                    <label class="input-group-text flex-centered" for="inputGroupSelect01">Typologie</label
                        >
                    </div>
                    <select 
                        class="custom-select" 
                        id="typology"
                        th:name="typology"
                    >
                        <option selected disabled>Sélectionnez...</option>
                        <option
                            th:each="typology : ${typologies}"
                            th:text="${typology.name}"
                            th:value="${typology.id}"
                        >
                            item
                        </option>
                    </select>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="work"
                            >Travaux</label
                        >
                    </div>
                    <select
                        class="custom-select"
                        id="work"
                        th:name="work"
                    >
                        <option selected disabled>Sélectionnez...</option>
                        <option
                            th:each="task : ${tasks}"
                            th:text="${task.work.name}"
                            th:value="${task.work.id}"
                            th:attr="filter=${task.typology.id}"
                            >item</option
                        >
                    </select>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="material"
                            >Matériaux</label
                        >
                    </div>
                    <select
                        class="custom-select"
                        id="material"
                        th:name="material"
                    >
                        <option selected disabled>Sélectionnez...</option>
                        <option
                            th:each="task : ${tasks}"
                            th:text="${task.material.name}"
                            th:value="${task.material.id}"
                            th:attr="filter=${task.typology.id + ' ' + task.work.id}"
                            >item</option
                        >
                    </select>
                </div>
                <div class="quantity-selector-container">
                    <button type="button" onclick="quantity_select(this);" th:value="${surfaceA.toString()}" class="btn btn-outline-info d-flex justify-content-center align-items-center col-2">A</button>
                    <button type="button" onclick="quantity_select(this);" th:value="${surfaceB}" class="btn btn-outline-info d-flex justify-content-center align-items-center col-2">B</button>
                    <button type="button" onclick="quantity_select(this);" th:value="${surfaceA + surfaceB}" class="btn btn-outline-info d-flex justify-content-center align-items-center col-2">A+B</button>
                    <button type="button" onclick="quantity_select(this);" th:value="${surfaceA*2 + surfaceB*2}" class="btn btn-outline-info d-flex justify-content-center align-items-center col-2">4</button>
                    <button type="button" onclick="quantity_select(this);" th:value="${ground}" class="btn btn-outline-info d-flex justify-content-center align-items-center col-2">Sol</button>
                </div>
                <div class="input-group mb-3">
					<div class="input-group-prepend">
						<label class="input-group-text" for="quantity">Quantité / Surface</label>
					</div>
                    <input
                        id="quantity"
						type="number"
						class="form-control"
                        name="quantityValue"
                        step="0.01"
                        required
					/>
				</div>
                <button type="submit" class="btn btn-info">Ajouter</button>
            </form>
            <section class="section-list">
                <h3>Liste des travaux ajoutées :</h3>
                <ul class="list-group" th:each="quantity : ${quantities}">
                    <li 
                        class="list-group-item" 
                        th:text="${quantity.task.constructName() + ' - ' + quantity.quantity*quantity.task.price}"
                    >
                        Item
                    </li> 
                    <form
                                        th:action="@{'/quantity'}"
                                        th:method="DELETE"
                                    >
                                        <input
                                            type="hidden"
                                            th:value="${quantity.id}"
                                            th:name="quantity"
                                        />
                                        <button
                                            type="submit"
                                            class="btn btn-info"
                                        >
                                            <ion-icon
                                                ios="ios-close"
                                                md="md-close"
                                                class="icon-delete"
                                            ></ion-icon>
                                        </button>
                                    </form>
                </ul>         
            </section>
        </main>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script th:src="@{/JS/filter_task.js}"></script>
        <script th:src="@{/JS/quantity_selector.js}"></script>
        <div th:replace="fragments/footer.html :: footer"></div>
        <div th:replace="fragments/script.html :: script"></div>
    </body>
</html>